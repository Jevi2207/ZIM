<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Introduction to ZIM â€¢ ZIM</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/spacelab/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to ZIM">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ZIM</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">1.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">Home</a>
</li>
<li>
  <a href="../articles/ZIM.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/biostatstudio/ZIM">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Introduction to ZIM</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/biostatstudio/ZIM/blob/master/vignettes/ZIM.Rmd"><code>vignettes/ZIM.Rmd</code></a></small>
      <div class="hidden name"><code>ZIM.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(ZIM)</a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">data</span>(syph)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">count &lt;-<span class="st"> </span>syph<span class="op">$</span>a33</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">ar1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/bshift.html">bshift</a></span>(count <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">trend &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(count) <span class="op">/</span><span class="st"> </span><span class="dv">1000</span></a></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw">plot</span>(<span class="kw">ts</span>(count), <span class="dt">xlab =</span> <span class="st">"Week"</span>, <span class="dt">ylab =</span> <span class="st">"Number of Syphilis Cases"</span>, </a>
<a class="sourceLine" id="cb3-2" data-line-number="2">     <span class="dt">main =</span> <span class="st">"Maryland (2007 - 2010)"</span>, <span class="dt">type =</span> <span class="st">"o"</span>, <span class="dt">pch =</span> <span class="dv">20</span>, <span class="dt">las =</span> <span class="dv">1</span>)</a></code></pre></div>
<p><img src="ZIM_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">table</span>(count)</a></code></pre></div>
<pre><code>## count
##  0  1  2  3  4  5  6  7  8  9 10 11 12 15 
## 59 10 14 24 26 26 18 14  3  7  4  2  1  1</code></pre>
<div id="observation-driven-models" class="section level2">
<h2 class="hasAnchor">
<a href="#observation-driven-models" class="anchor"></a>Observation-Driven Models</h2>
<div id="zip-autoregression" class="section level3">
<h3 class="hasAnchor">
<a href="#zip-autoregression" class="anchor"></a>ZIP Autoregression</h3>
<p>We first fit a ZIP autoregression with an AR(1) correlation structure. The linear trend is included in both the log-linear and logistic parts of the model.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1">m1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/zim.html">zim</a></span>(count <span class="op">~</span><span class="st"> </span>ar1 <span class="op">+</span><span class="st"> </span>trend <span class="op">|</span><span class="st"> </span>trend)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2">m1</a></code></pre></div>
<pre><code>## 
## Call:
## zim(formula = count ~ ar1 + trend | trend)
## 
## Coefficients (log-linear): 
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  1.48942    0.11995 12.4175  &lt; 2e-16 ***
## ar1          0.22111    0.10072  2.1954  0.02813 *  
## trend       -1.01004    0.66687 -1.5146  0.12987    
## 
## Coefficients (logistic): 
##             Estimate Std. Error z value  Pr(&gt;|z|)    
## (Intercept) -1.93321    0.37196 -5.1974 2.021e-07 ***
## trend        8.60517    2.80827  3.0642  0.002182 ** 
## ---
## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 
## 
## Test for overdispersion (H0: ZIP vs. H1: ZINB) 
## score.test: 2.6031 
## p.value: 0.0046196 
## 
## Criteria for assessing goodness of fit 
## loglik: -454.3903 
## aic: 918.7806 
## bic: 935.4683 
## tic: 920.7761 
## 
## Number of EM-NR iterations: 11 
## Maximum absolute gradient: 2.975398e-14</code></pre>
<p>The EM-NR algorithm is used as the default algorithm in the zim function. The score test for overdispersion suggests that the ZINB model could provide a better fit to the syphilis data (p = 0.0046).</p>
</div>
<div id="zinb-autoregression" class="section level3">
<h3 class="hasAnchor">
<a href="#zinb-autoregression" class="anchor"></a>ZINB Autoregression</h3>
<p>As suggested by the score test, we next fit a ZINB autoregression, with all the other components remaining the same as in the ZIP autoregression.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1">m2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/zim.html">zim</a></span>(count <span class="op">~</span><span class="st"> </span>ar1 <span class="op">+</span><span class="st"> </span>trend <span class="op">|</span><span class="st"> </span>trend, <span class="dt">dist =</span> <span class="st">"zinb"</span>)</a>
<a class="sourceLine" id="cb8-2" data-line-number="2">m2</a></code></pre></div>
<pre><code>## 
## Call:
## zim(formula = count ~ ar1 + trend | trend, dist = "zinb")
## 
## Coefficients (log-linear): 
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  1.47240    0.13873 10.6132  &lt; 2e-16 ***
## ar1          0.23164    0.11522  2.0105  0.04438 *  
## trend       -1.00364    0.77154 -1.3008  0.19332    
## 
## Coefficients (logistic): 
##             Estimate Std. Error z value  Pr(&gt;|z|)    
## (Intercept) -1.97940    0.38563 -5.1329 2.853e-07 ***
## trend        8.71684    2.88697  3.0194  0.002533 ** 
## ---
## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 
## 
## (Dispersion parameter for negative binomial taken to be 15.4711) 
## 
## Criteria for assessing goodness of fit 
## loglik: -451.7464 
## aic: 915.4927 
## bic: 935.5179 
## tic: 915.974 
## 
## Number of EM-NR iterations: 11 
## Maximum absolute gradient: 5.087792e-08</code></pre>
<p>The AIC and TIC suggest a marginal improvement when the ZINB autoregression is used. However, the BIC values for the ZIP and ZINB autoregressions are not distinguishable. This should not be surprising as BIC tends to penalize more for complexity.</p>
</div>
</div>
<div id="parameter-driven-models" class="section level1">
<h1 class="hasAnchor">
<a href="#parameter-driven-models" class="anchor"></a>Parameter-Driven Models</h1>
<div id="dynamic-zip-model" class="section level3">
<h3 class="hasAnchor">
<a href="#dynamic-zip-model" class="anchor"></a>Dynamic ZIP Model</h3>
<p>We now fit a dynamic ZIP model to the syphilis data. The trend is included as a deterministic covariate in the log-linear model. The zero-inflation parameter is assumed to be constant over time.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="kw">system.time</span>(m3 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/dzim.html">dzim</a></span>(count <span class="op">~</span><span class="st"> </span>trend, <span class="dt">dist =</span> <span class="st">"zip"</span>, <span class="dt">N =</span> <span class="dv">100</span>, <span class="dt">R =</span> <span class="dv">100</span>, <span class="dt">niter =</span> <span class="dv">50</span>))</a></code></pre></div>
<pre><code>##    user  system elapsed 
## 108.142   4.950 113.218</code></pre>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">m3</a></code></pre></div>
<pre><code>## 
## Call:
## dzim(formula = count ~ trend, dist = "zip", N = 100, R = 100,     niter = 50)
## 
## (Zero-inflation parameter taken to be 0.2659) 
## 
## Coefficients (log-linear): 
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  1.665769   0.083059 20.0553  &lt; 2e-16 ***
## trend       -1.509349   0.744136 -2.0283  0.04253 *  
## 
## Coefficients (autoregressive): 
##      Estimate Std. Error z value Pr(&gt;|z|)
## ar1 -0.039305   0.706037 -0.0557   0.9556
## ---
## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 
## 
## (Standard deviation parameter taken to be 0.2644) 
## 
## Criteria for assessing goodness of fit 
## loglik: -461.031 
## aic: 932.0621 
## bic: 948.7737 
## tic: 1172.527</code></pre>
</div>
<div id="dynamic-zinb-model" class="section level3">
<h3 class="hasAnchor">
<a href="#dynamic-zinb-model" class="anchor"></a>Dynamic ZINB Model</h3>
<p>We next fit a dynamic ZINB model to see whether a need remains for the NB dispersion parameter.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">123</span>)</a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="kw">system.time</span>(m4 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/dzim.html">dzim</a></span>(count <span class="op">~</span><span class="st"> </span>trend, <span class="dt">dist =</span> <span class="st">"zinb"</span>, <span class="dt">N =</span> <span class="dv">100</span>, <span class="dt">R =</span> <span class="dv">100</span>, <span class="dt">niter =</span> <span class="dv">50</span>))</a></code></pre></div>
<pre><code>##    user  system elapsed 
## 114.224   5.110 119.482</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">m4</a></code></pre></div>
<pre><code>## 
## Call:
## dzim(formula = count ~ trend, dist = "zinb", N = 100, R = 100,     niter = 50)
## 
## (Zero-inflation parameter taken to be 0.2666) 
## 
## (Dispersion parameter for negative binomial taken to be 28.7215) 
## 
## Coefficients (log-linear): 
##              Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  1.664849   0.085761 19.4126  &lt; 2e-16 ***
## trend       -1.417810   0.761383 -1.8622  0.06258 .  
## 
## Coefficients (autoregressive): 
##       Estimate Std. Error z value Pr(&gt;|z|)
## ar1 -0.0067421  0.6117034  -0.011   0.9912
## ---
## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 
## 
## (Standard deviation parameter taken to be 0.2163) 
## 
## Criteria for assessing goodness of fit 
## loglik: -461.3512 
## aic: 934.7024 
## bic: 954.7564 
## tic: 1248.151</code></pre>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#observation-driven-models">Observation-Driven Models</a></li>
      <li><a href="#parameter-driven-models">Parameter-Driven Models</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Ming Yang, Gideon Zamba, Joseph Cavanaugh.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
