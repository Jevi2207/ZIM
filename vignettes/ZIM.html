<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">



<title>Introduction to ZIM</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>

</head>

<body>




<h1 class="title toc-ignore">Introduction to ZIM</h1>



<p>In the <code>ZIM</code> package, <code>zim</code>, <code>zim.fit</code>, and <code>zim.control</code> are the main functions to implement the ZIP and ZINB autoregressions. The function <code>zim</code> is a user-friendly function to fit zero-inflated observation-driven models. Its usage is very similar to that of the well-known function <code>glm</code>. Here, <code>zim.fit</code> is the fitter function and it is called by <code>zim</code> to fit the models. The <code>zim.fit</code> function should not be used directly unless by experienced users. The function <code>zim.control</code> is an auxiliary function for <code>zim</code> fitting. It is typically only used internally by <code>zim.fit</code>, but may be used to contruct a <code>control</code> argument to either function.</p>
<p>Compared to observation-driven models, parameter estimation in parameter-driven models is much more challenging (<code>dzim</code>, <code>dzim.fit</code>, <code>dzim.filter</code>, <code>dzim.smooth</code>, <code>dzim.control</code>). The following are the functions that can be used to fit the dynamic ZIP and ZINB models. In addition, the dynamic Poisson and NB models can also be fit since they are simply special cases of the dynamic zero-infalted models. The function <code>dzim</code> is a user-friendly function to fit dynamic zero-inflated models. The default order for the autoregressive process is assumed to be one. Here, <code>dzim.fit</code> is the fitter function and it is called by <code>dzim</code> to fit the models. The function <code>dzim.control</code> is an auxiliary function for <code>dzim</code> fitting. The functions <code>dzim.filter</code> and <code>dzim.smooth</code> are used to implement the particle filtering and particle smoothing methods, respectively.</p>
<div id="observation-driven-models" class="section level2">
<h2>Observation-Driven Models</h2>
<div id="zip-autoregression" class="section level3">
<h3>ZIP Autoregression</h3>
<p>We first fit a ZIP autoregression with an AR(1) correlation structure. The linear trend is included in both the log-linear and logistic parts of the model.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw">library</span>(ZIM)</a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">data</span>(syph)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">count &lt;-<span class="st"> </span>syph<span class="op">$</span>a33</a>
<a class="sourceLine" id="cb2-3" data-line-number="3">ar1 &lt;-<span class="st"> </span><span class="kw">bshift</span>(count <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb2-4" data-line-number="4">trend &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(count) <span class="op">/</span><span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="kw">zim</span>(count <span class="op">~</span><span class="st"> </span>ar1 <span class="op">+</span><span class="st"> </span>trend <span class="op">|</span><span class="st"> </span>trend)</a></code></pre></div>
<pre><code>## 
## Call:
## zim(formula = count ~ ar1 + trend | trend)
## 
## Coefficients (log-linear): 
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  1.48942    0.11995 12.4175  &lt; 2e-16 ***
## ar1          0.22111    0.10072  2.1954  0.02813 *  
## trend       -1.01004    0.66687 -1.5146  0.12987    
## 
## Coefficients (logistic): 
##             Estimate Std. Error z value  Pr(&gt;|z|)    
## (Intercept) -1.93321    0.37196 -5.1974 2.021e-07 ***
## trend        8.60517    2.80827  3.0642  0.002182 ** 
## ---
## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 
## 
## Test for overdispersion (H0: ZIP vs. H1: ZINB) 
## score.test: 2.6031 
## p.value: 0.0046196 
## 
## Criteria for assessing goodness of fit 
## loglik: -454.3903 
## aic: 918.7806 
## bic: 935.4683 
## tic: 920.7761 
## 
## Number of EM-NR iterations: 11 
## Maximum absolute gradient: 2.975398e-14</code></pre>
<p>The EM-NR algorithm is used as the default algorithm in the zim function. The score test for overdispersion suggests that the ZINB model could provide a better fit to the syphilis data (p = 0.0046).</p>
</div>
<div id="zinb-autoregression" class="section level3">
<h3>ZINB Autoregression</h3>
<p>As suggested by the score test, we next fit a ZINB autoregression, with all the other components remaining the same as in the ZIP autoregression.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw">zim</span>(count <span class="op">~</span><span class="st"> </span>ar1 <span class="op">+</span><span class="st"> </span>trend <span class="op">|</span><span class="st"> </span>trend, <span class="dt">dist =</span> <span class="st">&quot;zinb&quot;</span>)</a></code></pre></div>
<pre><code>## 
## Call:
## zim(formula = count ~ ar1 + trend | trend, dist = &quot;zinb&quot;)
## 
## Coefficients (log-linear): 
##             Estimate Std. Error z value Pr(&gt;|z|)    
## (Intercept)  1.47240    0.13873 10.6132  &lt; 2e-16 ***
## ar1          0.23164    0.11522  2.0105  0.04438 *  
## trend       -1.00364    0.77154 -1.3008  0.19332    
## 
## Coefficients (logistic): 
##             Estimate Std. Error z value  Pr(&gt;|z|)    
## (Intercept) -1.97940    0.38563 -5.1329 2.853e-07 ***
## trend        8.71684    2.88697  3.0194  0.002533 ** 
## ---
## Signif. codes: 0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1 
## 
## (Dispersion parameter for negative binomial taken to be 15.4711) 
## 
## Criteria for assessing goodness of fit 
## loglik: -451.7464 
## aic: 915.4927 
## bic: 935.5179 
## tic: 915.974 
## 
## Number of EM-NR iterations: 11 
## Maximum absolute gradient: 5.087792e-08</code></pre>
<p>The AIC and TIC suggest a marginal improvement when the ZINB autoregression is used. However, the BIC values for the ZIP and ZINB autoregressions are not distinguishable. This should not be surprising as BIC tends to penalize more for complexity.</p>
</div>
</div>
<div id="parameter-driven-models" class="section level1">
<h1>Parameter-Driven Models</h1>
<div id="dynamic-zip-model" class="section level3">
<h3>Dynamic ZIP Model</h3>
<p>We now fit a dynamic ZIP model to the syphilis data. The trend is included as a deterministic covariate in the log-linear model. The zero-inflation parameter is assumed to be constant over time.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">dzim</span>(count <span class="op">~</span><span class="st"> </span>trend, <span class="dt">dist =</span> <span class="st">&quot;zip&quot;</span>)</a></code></pre></div>
</div>
<div id="dynamic-zinb-model" class="section level3">
<h3>Dynamic ZINB Model</h3>
<p>We next fit a dynamic ZINB model to see whether a need remains for the NB dispersion parameter.</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1"><span class="kw">dzim</span>(count <span class="op">~</span><span class="st"> </span>trend, <span class="dt">dist =</span> <span class="st">&quot;zinb&quot;</span>)</a></code></pre></div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
